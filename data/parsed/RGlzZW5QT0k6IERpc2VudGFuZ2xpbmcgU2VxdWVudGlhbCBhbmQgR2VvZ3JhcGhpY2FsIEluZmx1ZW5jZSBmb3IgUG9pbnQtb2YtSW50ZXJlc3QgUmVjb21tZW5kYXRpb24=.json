{
  "DisenPOI: Disentangling Sequential and Geographical Influence for Point-of-Interest Recommendation": "Yifang Qin ‚àó qinyifang@pku.edu.cn Peking University Beijing, China Fang Sun ‚àó fts@pku.edu.cn Peking University Beijing, China Wei Ju ‚Ä† juwei@pku.edu.cn Peking University Beijing, China",
  "Jia Cheng": "jia.cheng.sh@meituan.com Meituan Beijing, China",
  "Yifan Wang ‚àó": "yifanwang@pku.edu.cn Peking University Beijing, China",
  "Xuyang Hou": "houxuyang@meituan.com Meituan Beijing, China",
  "Jun Lei": "leijun@meituan.com Meituan Beijing, China",
  "ABSTRACT": "",
  "Zhe Wang": "wangzhe65@meituan.com Meituan Beijing, China",
  "Ming Zhang ‚Ä†": "mzhang_cs@pku.edu.cn Peking University Beijing, China",
  "KEYWORDS": "Point-of-Interest (POI) recommendation plays a vital role in various location-aware services. It has been observed that POI recommendation is driven by both sequential and geographical influences. However, since there is no annotated label of the dominant influence during recommendation, existing methods tend to entangle these two influences, which may lead to sub-optimal recommendation performance and poor interpretability. In this paper, we address the above challenge by proposing DisenPOI , a novel Disen tangled dual-graph framework for POI recommendation, which jointly utilizes sequential and geographical relationships on two separate graphs and disentangles the two influences with self-supervision. The key novelty of our model compared with existing approaches is to extract disentangled representations of both sequential and geographical influences with contrastive learning. To be specific, we construct a geographical graph and a sequential graph based on the check-in sequence of a user. We tailor their propagation schemes to become sequence-/geo-aware to better capture the corresponding influences. Preference proxies are extracted from check-in sequence as pseudo labels for the two influences, which supervise the disentanglement via a contrastive loss. Extensive experiments on three datasets demonstrate the superiority of the proposed model.",
  "CCS CONCEPTS": "",
  "¬∑ Information systems ‚Üí Recommender systems .": "‚àó Authors contributed equally to this research. ‚Ä† Co-corresponding authors. Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from permissions@acm.org. WSDM '23, February 27-March 3, 2023, Singapore, Singapore. ¬© 2023 Association for Computing Machinery. ACM ISBN 978-1-4503-9407-9/23/02...$15.00 https://doi.org/10.1145/3539597.3570408 POI Recommendation, Graph Neural Networks, Disentangled Representation Learning",
  "ACMReference Format:": "Yifang Qin, Yifan Wang, Fang Sun, Wei Ju, Xuyang Hou, Zhe Wang, Jia Cheng, Jun Lei, and Ming Zhang. 2023. DisenPOI: Disentangling Sequential and Geographical Influence for Point-of-Interest Recommendation. In Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining (WSDM '23), February 27-March 3, 2023, Singapore, Singapore. ACM, New York, NY, USA, 9 pages. https://doi.org/10.1145/3539597.3570408",
  "1 INTRODUCTION": "The rapid growth of Location-Based Social Networks (LBSNs) has facilitated the development of Point-of-Interest (POI) recommendation, which lies at the heart of various location-based services, including location-based advertising and online food delivery. POI recommendation is the backbone for numerous popular Apps, such as Foursquare, Gowalla and Meituan. A POI can be a restaurant, a hotel, a scenic spot, or any location-tagged item. Location is much more than an ordinary feature dimension in POI recommendation: it builds up a network structure among POIs, inter-connected by both their interactive history sequence and geographical affinity. Recent works on POI recommendation endeavor to integrate geographical influences with sequential transitions of user checkin data. Sequence-based methods like LSTPM [24] combine user's long-term interest with geo-dilated short-term interest, using geographical affinity as an auxiliary in modeling sequence behavior. GeoIE [28] explicitly uses physical distance to model user-specific geographical influence and GTAG [40] performs preference propagation based on physical distance and time-slot affinity. Despite the versatility of these POI recommenders, there are rarely approaches that explicitly uncover the collaborative signals. The complex interactions among users and POIs can be readily delineated by graphs, therefore a promising approach is to leverage the rich graph structure to exploit high-order connectivity between POIs. WSDM'23, February 27-March 3, 2023, Singapore, Singapore. Yifang Qin et al. Graph Neural Networks (GNNs) have been extensively deployed for recommendation to better capture the similarities between highorder neighbors. NGCF [30] and LightGCN [10] collects the collaborative signal on the user-POI bipartite graph, SR-GNN [36] propagates along the user's interactive sequence graph. Although these paradigms provide valuable insight as to organizing interaction data into graph structures for POI recommendation, they do not leverage geographical relationships, which is a prominent characteristic in POI recommendation. In fact, sequential influence and geographical influence should be regarded as equal counterparts, which are two of the major driving forces in POI recommendation. As the example in Figure 1 shows, a user's visit to ùë£ 4 is influenced by its neighboring nodes from geographical and sequential graphs. On the one hand, users are apt to re-visit familiar POIs that have already shown up in their interaction sequences. For example, frequent visits to clothing stores may reveal a user's preference in fashion, which indicates that a similar clothing store has more chance to be the next-tovisit POI. On the other hand, POIs in the vicinity are also more likely to be visited. For instance, a user who has just come out of a downtown shopping mall is more likely to have lunch in a nearby fast-food restaurant, rather than his/her favorite restaurant in the countryside. The two influences affect user behaviors in inherently different ways, which the previous approaches for POI recommendation do not try to distinguish. Since these approaches impose no explicit supervision on the learned user preference, there is no guarantee for the explicit capture of sequential influence and geographical influence in the user preference. In face of the dual influences on user preference, the key is not simple combination, but rather, disentanglement . Specifically, to depict user preference at a finer granularity and enhance POI recommendation quality, we need to disentangle the two latent driving forces, thus distilling the representations for both influences provides better interpretability. Existing disentanglement models for recommendation either use dynamic routing (e.g. DGCF [32], DisenCTR [33]) or self-supervised signals (e.g. MacridVAE [20], CLSR [42]) to disentangle latent interests, yet how to disentangle sequential and geographical influences remains unexplored. In a nutshell, the ubiquity and uniqueness of the two influences in LBSNs pose two major challenges to POI recommendation: First , how to depict these two high-order connectivity influences for the user check-in data? Second , How to explicitly disentangle these two influences for POI recommendation? To address the aforementioned challenges, we propose DisenPOI , a novel Disen tangled dual-graph framework for POI Recommendation, which explicitly models sequential and geographical influences on user check-in data. DisenPOI constructs two disentangled POI graphs: a geographical graph based on spatial affinity, and a sequential graph based on interaction history. To better capture high-order connectivity on different graph topologies, a distanceaware and a sequence-aware GNN are proposed to propagate on the corresponding geographical and sequential graph. We adopt contrastive learning methods to disentangle the graph representations in a self-supervised way.With the help of disentangled representations, DisenPOI can make recommendations that reflect both sequential and geographical influence. We summarize our main contributions as follows: <latexi sh1_b64=\"RFvcCAH3dZKo9MLG0zyJ>BnVNS8EUrq/PgDwm7IQjkXWYu+O2fT5p <latexi sh1_b64=\"RFvcCAH3dZKo9MLG0zyJ>BnVNS8EUrq/PgDwm7IQjkXWYu+O2fT5p < l a t e x i s h 1 _ b 6 4 = \" p d C G + f g X j P 9 T r I / S v D 5 V Y > A B n c L J E O z F H R U y Z k m 7 w < l a t e x i s h 1 _ b 6 4 = \" 2 E K W v / D N O w X 9 n z f 0 5 M > A B c V L T g J F + I j H R q 8 Y Z d C P G < l a t e x i s h 1 _ b 6 4 = \" O 3 2 0 B 8 E m X N Q q L d r Y > A n c V S J W K o k U 9 j G / M y 7 u p F C f I D R < l a t e x i s h 1 _ b 6 4 = \" V 7 v p U u O M y m 9 g 2 X 5 B r I d > A n c D L T J E z F + j H R Y N P o Z k C w N 8 o W q Q K 2 3 M u 0 k 3 r S p u 7 o U y Q m 5 + P g v Z T z H w 8 f G S W q Q K / 3 0 < l a t e x i s h 1 _ b 6 4 = \" g R + w 8 z f S I A O E Y q c n u N r k > B V D L T J F 9 j H U 5 y Z d p 7 G o X v P C W Q m / M 0 K 3 2 < l a t e x i s h 1 _ b 6 4 = \" g R + w 8 z f S I A O E Y q c n u N r k > B V D L T J F 9 j H U 5 y Z d p 7 G o X v P C W Q m / M 0 K 3 2 < l a t e x i s h 1 _ b 6 4 = \" Y m g C M q 7 F u v 9 8 0 A f k > B n c V D L T J E O z + I j H R N y Z d p w S U G o X P W Q / 5 K 3 2 r < l a t e x i s h 1 _ b 6 4 = \" Y m g C M q 7 F u v 9 8 0 A f k > B n c V D L T J E O z + I j H R N y Z d p w S U G o X P W Q / 5 K 3 2 r < l a t e x i s h 1 _ b 6 4 = \" p d C G + f g X j P 9 T r I / S v D 5 V Y > A B n c L J E O z F H R U y Z k m 7 w N 8 o W q Q K 2 3 M u 0 < l a t e x i s h 1 _ b 6 4 = \" p d C G + f g X j P 9 T r I / S v D 5 V Y > A B n c L J E O z F H R U y Z k m 7 w N 8 o W q Q K 2 3 M u 0 < l a t e x i s h 1 _ b 6 4 = \" 2 E K W v / D N O w X 9 n z f 0 5 M > A B c V L T g J F + I j H R q 8 Y Z d C P G k 3 r S p u 7 o U y Q m < l a t e x i s h 1 _ b 6 4 = \" 2 E K W v / D N O w X 9 n z f 0 5 M > A B c V L T g J F + I j H R q 8 Y Z d C P G k 3 r S p u 7 o U y Q m < l a t e x i s h 1 _ b 6 4 = \" R F v c C A H 3 d Z K o 9 M L G 0 z y J > B n V N S 8 E U r q / P g D w m 7 I Q j k X W Y u + O 2 f T 5 p < l a t e x i s h 1 _ b 6 4 = \" R F v c C A H 3 d Z K o 9 M L G 0 z y J > B n V N S 8 E U r q / P g D w m 7 I Q j k X W Y u + O 2 f T 5 p < l a t e x i s h 1 _ b 6 4 = \" O 3 2 0 B 8 E m X N Q q L d r Y > A n c V S J W K o k U 9 j G / M y 7 u p F C f I D R 5 + P g v Z T z H w < l a t e x i s h 1 _ b 6 4 = \" O 3 2 0 B 8 E m X N Q q L d r Y > A n c V S J W K o k U 9 j G / M y 7 u p F C f I D R 5 + P g v Z T z H w < l a t e x i s h 1 _ b 6 4 = \" V 7 v p U u O M y m 9 g 2 X 5 B r I d > A n c D L T J E z F + j H R Y N P o Z k C w 8 f G S W q Q K / 3 0 < l a t e x i s h 1 _ b 6 4 = \" V 7 v p U u O M y m 9 g 2 X 5 B r I d > A n c D L T J E z F + j H R Y N P o Z k C w 8 f G S W q Q K / 3 0 < l a t e x i s h 1 _ b 6 4 = \" U z p f 8 o B / j P 9 + A q 2 r G u W Q > n c V D L T g J E O F I H R Y N y Z k d w 7 m S X v C K 3 0 M 5 < l a t e x i s h 1 _ b 6 4 = \" U z p f 8 o B / j P 9 + A q 2 r G u W Q > n c V D L T g J E O F I H R Y N y Z k d w 7 m S X v C K 3 0 M 5 Figure 1: An illustration of disentangled influences behind check-ins. A visit to ùë£ 4 is influenced by its neighbouring nodes from geographical and sequential graph. v 1 v 2 v 3 v 1 v 4 v 5 User User Preference Geographical Influence Sequential Influence v 7 v 8 v 2 v 3 v 1 v 4 v 5 v 6 v 1 v 2 v 3 v 4 v 5 Sequential Graph v 7 v 8 v 6 Geographical Graph ¬∑ We construct dual graphs from user's visiting interactions to jointly utilize both sequential and geographical relationships, devising sequence- and geo-aware propagation schemes for the two graphs respectively to improve embedding quality. ¬∑ We propose to extract disentangled representations of sequential and geographical influences. Sequential and geographical proxies are obtained as self-supervised signals, which are specially tailored for the LBSN setting. To the best of our knowledge, this is the first graph-based POI recommendation framework with disentangled sequential and geographical representations. ¬∑ We conduct extensive experiments on three real-world benchmarks for POI recommendation. Our model consistently outperforms strong baselines, achieving state-of-the-art performance on all three benchmark datasets.",
  "2 RELATED WORK": "",
  "2.1 Location-based POI Recommendation": "Location-based POI recommendation puts special emphasis on the geographical features of POIS. GeoIE [28] models geographical influence between two POIs by the inner product of geo-influence and geo-susceptibility vectors. PACE [38] combines Matrix Factorization (MF) [23] approach with self-supervised learning to better exploit location information. There are also works [4, 17, 22] that leverage Markov Chain for next-POI prediction. This line of work [6, 18, 24, 27, 41] is characterized by their wide use of Recurrent Neural Networks (RNNs) for modeling sequential data. For example, LSTPM [24] combines geographical information with sequential method by estimating the spatial-temporal similarities and finding shortcuts between POIs. There are also works [3, 7, 8, 14] that consider the social influence between users.",
  "2.2 GNN-based Recommendation": "Graph Neural Networks (GNNs) like Graph Convolutional Network (GCN) [13], Gated Graph Neural Network (GGNN) [15] and Graph Attention Network (GAT) [26] have been consistently showing their potency with graph-structured data. GNNs learn the hidden representation of a graph node by passing and aggregating messages collected from its neighboring nodes. By stacking GNN layers, models[12, 19] are empowered to exploit high-order graph connectivity. Graph structures naturally exist among users and DisenPOI: Disentangling Sequential and Geographical Influence for Point-of-Interest Recommendation WSDM'23, February 27-March 3, 2023, Singapore, Singapore. items, which makes GNNs ideal for modeling recommendation tasks. NGCF [30] and its variant LightGCN [10] consider the collaborative signals on a user-item bipartite graph. DSGL [5] uses dynamic sequential graphs to model the dynamics of user's interaction history. Recently, works like KBGNN [11], GSTN [35], GEAPR [16] and IMUP [29] propose to integrate geographical factors into GNN-based recommendation to improve performance under location-based settings. However, every observed interaction can be driven by various ambient influences, as well as diverse user interests. Representations learned by GNNs cannot readily uncover these rich semantics.",
  "2.3 Disentangled Learning in Recommendation": "Disentangled Representation Learning [1] aims to learn separate explanatory representations from different latent factors behind data. MacridVAE [20] employs Variational Auto-Encoders (VAEs) to encode items via disentangled prototypes. CLSR [42] attempts to disentangle users' long and short-term interests from their clicking sequences. GNNs are also used in disentangled recommenders, which propose to learn disentangled representation from various graph structures. Such models include DGCF [32] (user-item graph), DisenHAN [34] (heterogeneous graph) and KGIN [31] (knowledge graph). Yet, the aforementioned works only perform disentangled learning on one type of graph topology. They are not intended to capture influences from POI locations, either. These short-comings shall be addressed by our proposed DisenPOI model, which uses two disentangled graphs to utilize sequential and geographical relationships, and extracts the rich semantics behind observed interactions by disentangling sequential and geographical influences.",
  "3 PRELIMINARY": "",
  "3.1 Problem Formulation": "Location-based Click Through Rate (CTR) prediction aims to leverage geographical information in user's interactive history with POIs. We denote the set of users as U = { ùë¢ 1 , ùë¢ 2 , ..., ùë¢ | U| } , and the set of POIs as V = { ùë£ 1 , ùë£ 2 , ..., ùë£ | V | } , where each POI ùë£ ‚àà V is geo-encoded by its coordinates ( ùëôùëúùëõùëîùëñùë°ùë¢ùëëùëí,ùëôùëéùë°ùëñùë°ùë¢ùëëùëí ) tuple, i.e. ( ùëôùëúùëõ ùë£ , ùëôùëéùë° ùë£ ) . For each user ùë¢ ‚àà U , his/her check-in sequence is organized into a list ùë† ùë¢ = [ ùë£ ùë¢, 1 , ùë£ ùë¢, 2 , ..., ùë£ ùë¢,ùë° -1 ] , containing the ùë° -1 POIs he/she has checked in, sorted by timestamp. Given user ùë¢ and target POI ùë£ , the goal of location-based CTR prediction is to predict the probability for ùë¢ to visit ùë£ , formulated as ÀÜ ùë¶ ùë¢ùë£ = ùëì ( ùë¢, ùë£ | ùë† ùë¢ ; ùúÉ ) , where ùëì is a learnable function parameterized by ùúÉ .",
  "3.2 Construction of Two Disentangled Graphs": "As we aim to make predictions based on both the geographical relationship between POIs and the sequential dependency in users' check-in history, two POI graphs with different propagation schemes are thus constructed to meet the two ends respectively. 3.2.1 Geographical Graph. The undirected geographical graph G ùëî = {V , E ùëî , ùê¥ ùëî } is built upon the location of POIs. An undirected edge ùëí ùëî = ( ùë£ ùëñ , ùë£ ùëó ) ‚àà E ùëî indicates that the distance between ùë£ ùëñ and ùë£ ùëó is within a specific distance threshold Œî ùëë . The edge weight matrix ùê¥ ùëî ( ùëñ, ùëó ) is the geographical distance between POI ùë£ ùëñ and ùë£ ùëó . The construction of G ùëî is based on the fact that a user would usually prefer a nearby POI for the next visit. 3.2.2 Sequential Graph. Inspired by previous work on sessionbased recommendation [36], we propose to construct sequential graphs for visiting sequences. Given a user ùë¢ and his/her check-in history ùë† ùë¢ , a directed sequential graph G ùë†,ùë¢ = {V ùë†,ùë¢ , E ùë†,ùë¢ } can then be constructed. For each edge ùëí ùë† = GLYPH<10> ùë£ ùëñ , ùë£ ùëó GLYPH<11> ‚àà G ùë† , it represents that the user has successively check-in to ùë£ ùëó after ùë£ ùëñ in ùë† ùë¢ . Thus, G ùë†,ùë¢ gleans sequential information from the check-in history.",
  "4 THE PROPOSED MODEL": "",
  "4.1 Overview": "The proposed model has four modules as illustrated in Figure 2. Given a user's check-in history and a target POI, the model first maps IDs of the involved POIs into a hidden space, i.e. ùëã ‚àà R ùê∑ √ó ùê∑ , to get their initial embeddings. After the POIs are mapped, the model constructs two graphs, ùê∫ ùëî and ùê∫ ùë† , which reflect the geographical and sequential features of the given visiting history respectively. Two graph propagation modules are used upon the drawn graphs to generate representations from a disentangled view. A soft-attention mechanism is applied to extract the user preference behind visits on both modules, in order to dynamically measure the influence of visited and nearby POIs on the target POI. To explicitly disentangle this hybrid influence into two independent fields, we introduce a contrastive auxiliary loss to ensure that each module is able to extract disentangled information from the corresponding POI graph. Finally, we use an MLP layer to aggregate these disentangled representations and generate CTR prediction for the target POI. During the training process, we adopt a curriculum learning scheme to integrate the contrastive loss with the target function. We control the curriculum weight to train the model in an easyto-difficult manner so that our model can be trained adequately to give valid predictions while maintaining effective disentanglement.",
  "4.2 Propagation on Disentangled Graphs": "The graph propagation layer encodes the constructed graphs and outputs two sets of POI representations with geographical and sequential information. Since the two disentangled graphs are organized according to sequential/geographical relationships, we apply sequence-/geo-aware graph propagation schemes on them respectively, to better exploit the intrinsic characteristics of each graph. 4.2.1 Geographical Graph Propagation Layer. Given the locationbased graph G ùëî , we build our geographical graph propagation layer using the message-passing scheme of GNNs [9, 37]. Message Construction. For a pair of neighboring POIs ùë£ ùëñ , ùë£ ùëó , the message on the ùëô -th layer is defined as:  where ùëì ùëë (¬∑) is the message encoding function that takes item representation ‚Ñé ( ùëô -1 ) from the previous GNN layer. Specifically, the input of the first layer is initialized with POI's embedding ùëã :  In order to better leverage the geographical information in G ùëî , the message function ùëì ùëë (¬∑) is expected to reflect the distance influence WSDM'23, February 27-March 3, 2023, Singapore, Singapore. Yifang Qin et al. < l a t e x i s h 1 _ b 6 4 = \" o V H 8 w + f D 3 I R q A j y J r U > B n c N S E / 9 L 0 m k M F 7 Q W 2 p Z P C z X Y u O d g G T v K 5 < l a t e x i s h 1 _ b 6 4 = \" 2 E K W v / D N O w X 9 n z f 0 5 M > A B c V L T g J F + I j H R q 8 Y Z d C P G k 3 r S p u 7 o U y Q m < l a t e x i s h 1 _ b 6 4 = \" O 3 2 0 B 8 E m X N Q q L d r Y > A n c V S J W K o k U 9 j G / M y 7 u p F C f I D R 5 + P g v Z T z H w < l a t e x i s h 1 _ b 6 4 = \" R F v c C A H 3 d Z K o 9 M L G 0 z y J > B n V N S 8 E U r q / P g D w m 7 I Q j k X W Y u + O 2 f T 5 p < l a t e x i s h 1 _ b 6 4 = \" R F v c C A H 3 d Z K o 9 M L G 0 z y J > B n V N S 8 E U r q / P g D w m 7 I Q j k X W Y u + O 2 f T 5 p < l a t e x i s h 1 _ b 6 4 = \" p d C G + f g X j P 9 T r I / S v D 5 V Y > A B n c L J E O z F H R U y Z k m 7 w N 8 o W q Q K 2 3 M u 0 < l a t e x i s h 1 _ b 6 4 = \" V 7 v p U u O M y m 9 g 2 X 5 B r I d > A n c D L T J E z F + j H R Y N P o Z k C w 8 f G S W q Q K / 3 0 < l a t e x i s h 1 _ b 6 4 = \" n C F g H 3 R P k B X 8 U y Y M 9 > A c V N S E J r q / L 0 G K D T w m 7 I Q j z W Z + O d p f o v 5 u 2 < l a t e x i s h 1 _ b 6 4 = \" g q 8 W A n R X m 5 z U u Y > B + c V D L S N F 2 p r f 7 d Z E o T J I O y P / 9 0 Q G v K 3 w j C k M H < l a t e x i s h 1 _ b 6 4 = \" X S N Q T u J k v G z / E q y P B W 8 0 > A + n c V D L F 2 p r f 7 d Z R o I O Y m g 5 9 K 3 w U j C M H < l a t e x i s h 1 _ b 6 4 = \" U z p f 8 o B / j P 9 + A q 2 r G u W Q > n c V D L T g J E O F I H R Y N y Z k d w 7 m S X v C K 3 0 M 5 < l a t e x i s h 1 _ b 6 4 = \" V 7 v p U u O M y m 9 g 2 X 5 B r I d > A n c D L T J E z F + j H R Y N P o Z k C w 8 f G S W q Q K / 3 0 < l a t e x i s h 1 _ b 6 4 = \" 2 E K W v / D N O w X 9 n z f 0 5 M > A B c V L T g J F + I j H R q 8 Y Z d C P G k 3 r S p u 7 o U y Q m < l a t e x i s h 1 _ b 6 4 = \" p d C G + f g X j P 9 T r I / S v D 5 V Y > A B n c L J E O z F H R U y Z k m 7 w N 8 o W q Q K 2 3 M u 0 < l a t e x i s h 1 _ b 6 4 = \" Y m g C M q 7 F u v 9 8 0 A f k > B n c V D L T J E O z + I j H R N y Z d p w S U G o X P W Q / 5 K 3 2 r < l a t e x i s h 1 _ b 6 4 = \" O 3 2 0 B 8 E m X N Q q L d r Y > A n c V S J W K o k U 9 j G / M y 7 u p F C f I D R 5 + P g v Z T z H w < l a t e x i s h 1 _ b 6 4 = \" n C F g H 3 R P k B X 8 U y Y M 9 > A c V N S E J r q / L 0 G K D T w m 7 I Q j z W Z + O d p f o v 5 u 2 < l a t e x i s h 1 _ b 6 4 = \" O 3 2 0 B 8 E m X N Q q L d r Y > A n c V S J W K o k U 9 j G / M y 7 u p F C f I D R 5 + P g v Z T z H w < l a t e x i s h 1 _ b 6 4 = \" R F v c C A H 3 d Z K o 9 M L G 0 z y J > B n V N S 8 E U r q / P g D w m 7 I Q j k X W Y u + O 2 f T 5 p < l a t e x i s h 1 _ b 6 4 = \" 2 E K W v / D N O w X 9 n z f 0 5 M > A B c V L T g J F + I j H R q 8 Y Z d C P G k 3 r S p u 7 o U y Q m < l a t e x i s h 1 _ b 6 4 = \" R F v c C A H 3 d Z K o 9 M L G 0 z y J > B n V N S 8 E U r q / P g D w m 7 I Q j k X W Y u + O 2 f T 5 p < l a t e x i s h 1 _ b 6 4 = \" W G O F 3 9 d m 2 n y Y K R N g > A B c V D L S E r f U o P 8 H v 0 T w p Z M j u 7 z Q / J X 5 q k + C I <latexi sh1_b64=\"V7vpUuOMym9g2X5BrId>AncDLTJEzF+jHRYNPoZkCw8fGSWqQK/30 < l a t e x i s h 1 _ b 6 4 = \" g R + w 8 z f S I A O E Y q c n u N r k > B V D L T J F 9 j H U 5 y Z d p 7 G o X v P C W Q m / M 0 K 3 2 < l a t e x i s h 1 _ b 6 4 = \" p d C G + f g X j P 9 T r I / S v D 5 V Y > A B n c L J E O z F H R U y Z k m 7 w N 8 o W q Q K 2 3 M u 0 < l a t e x i s h 1 _ b 6 4 = \" W p u 5 E m R C k c + d H L y T F A > B / n V D S N J 3 U 2 v q Z r Y K M O z I Q f j o 0 7 G w 9 8 g P X < l a t e x i s h 1 _ b 6 4 = \" W p u 5 E m R C k c + d H L y T F A > B / n V D S N J 3 U 2 v q Z r Y K M O z I Q f j o 0 7 G w 9 8 g P X < l a t e x i s h 1 _ b 6 4 = \" 8 5 R 3 q G d o j O X C g + J u V w > A B 7 n c N S E U r / 9 L v F Y p m 2 Z y 0 M P W H T Q K k I f z D < l a t e x i s h 1 _ b 6 4 = \" f k c u 5 3 2 w 8 C H O P R z X > A B 7 n V N S E J U r q / 9 L g o v F Y G p m j Z d y 0 M W T + Q K I D < l a t e x i s h 1 _ b 6 4 = \" p R 0 C I T c 2 9 A Z f P M F d L O > X V B N S 8 E 3 U r q / o J Y Q w 7 m + W K D G u j y g 5 z v H n k < l a t e x i s h 1 _ b 6 4 = \" 3 W q m I 9 Z 5 T c v E r U O Q > A B 7 n V N S w M J 2 X + C R g d K j f y Y z p / k 0 P H D 8 u F o G L < l a t e x i s h 1 _ b 6 4 = \" C d T 5 W 2 A p o Z 0 F X 3 R J + > B 7 n c V N S w M E g K q j f y Y z Q / k r P v H D I 8 u U 9 G L O m < l a t e x i s h 1 _ b 6 4 = \" 8 5 R 3 q G d o j O X C g + J u V w > A B 7 n c N S E U r / 9 L v F Y p m 2 Z y 0 M P W H T Q K k I f z D < l a t e x i s h 1 _ b 6 4 = \" Y F J g d H w v L Q r U O I q N X 8 f K > A B n c V S E 3 / 9 0 m k M 7 o W y 2 p Z P C j z + G T D R 5 u < l a t e x i s h 1 _ b 6 4 = \" f k c u 5 3 2 w 8 C H O P R z X > A B 7 n V N S E J U r q / 9 L g o v F Y G p m j Z d y 0 M W T + Q K I D < l a t e x i s h 1 _ b 6 4 = \" j 5 k p 0 G n v w 7 f Q 2 N / o K U > A B c V S 8 E J 3 r q 9 L P R g D T m y H u + M W z d Z F Y I C O X < l a t e x i s h 1 _ b 6 4 = \" M T S + 8 U v D J A P r p 2 j B > n c V N E 3 q / 9 L 0 G R K g w m 7 Q H y 5 u f F d W o Z k C I Y O z X Figure 2: Illustration of DisenPOI. A) Embedding Layer for POIs; B) graph propagation layer that generates disentangled representations ùëí ùëî,ùë¢ , ùëí ùë†,ùë¢ and their proxies ùëù ùëî,ùë¢ , ùëù ùë†,ùë¢ ; C) soft-attention layer that aggregates POI embeddings for contrastive loss and model prediction; D) prediction layer to make predictions. Embedding Layer v 2 v 3 v 4 v 5 v 1 v 3 v 4 v 1 v 2 v 1 v 5 v 1 v 2 v 3 v 4 v 5 v 6 v 7 v 8 v 9 Sess-graph Encoder Geo-graph Encoder Contrastive L con Target Attention Layer v t e g‚Ü™u e s‚Ü™u x t h t ¬∂ Concat MLP Prediction ÀÜ y A B C D s u Target G s‚Ü™u G g‚Ü™u v t Construct graph pair e g‚Ü™u e s‚Ü™u p g‚Ü™u p s‚Ü™u READOUT( ¬∑ ) READOUT( ¬∑ ) between POIs. Specifically, POIs that are closer tend to share more similarities than distant ones. Formally, ùëì ùëë (¬∑) is implemented as:  where ùëä 1 , ùëä 2 ‚àà R ùê∑ √ó ùê∑ are trainable weight matrices as linear transformations for lower layer representations. To take the effect of distance into consideration, an element-wise production item is included. Distance kernel ùë§ ( ùëë ùëñ ùëó ) = ùëí -ùëë 2 ùëñ ùëó decays exponentially as ùëë ùëñ ùëó , the distance between ùë£ ùëñ and ùë£ ùëó grows. We use the graph Laplacian norm like GCNs [13], where N ùëñ and N ùëó denote the firsthop neighbors for ùë£ ùëñ and ùë£ ùëó on G ùëî respectively. Message Aggregation. To generate node representations on each GNN layer, the message aggregation function is defined as:  where ùëö ùëó ‚Üê ùëó = ùëä 1 ‚Ñé ( ùëô -1 ) ùëó is induced by the representation of ùë£ ùëó . After propagating along ùêø GNN layers, we adopt the hidden representation of the ùêø -th layer as the geographical encoding of all the POIs in V :  As for user ùë¢ with check-in history ùë† ùë¢ , we assume that his/her geographical preference can be captured by aggregating the highorder geographical neighbors of POIs in his/her check-in history. In practice, the user's geographical encoding ùêª ùëî,ùë¢ is the list of the geographical embeddings of all the POIs that appear in ùë† ùë¢ . 4.2.2 Sequential Graph Propagation Layer. Given a target user ùë¢ and the constructed sequential graph G ùë†,ùë¢ , we obtain the hidden representation of each item in the user's visiting history to exploit sequential influence. A user's visit sequence contains not only information about his preferences on POIs, but also the evolving history of his interests, which implies his tendency for the next POI to visit. Since plain GCNs are sequential-invariant, we consider adopting a graph propagation method that can fully leverage sequential information in the session graph. For the given reasons, we apply Gated Graph Neural Networks (GGNNs) [15] on G ùë†,ùë¢ to better leverage the sequential information. For each node ùë£ ùëñ ‚àà G ùë†,ùë¢ and its embedding ùë• ùëñ , the hidden representation of ùë£ is updated as:       where connection matrix ùê¥ ùë£ ‚àà R | V | √ó 2 | V | determines the connectivity of nodes in G ùë†,ùë¢ , ùëä s and ùëà s are trainable parameters. Inspired by Gate Recurrent Unit (GRU), GGNN proceeds on all nodes of the sequential graph sequentially. The propagation of hidden states is controlled by an update gate ùëß ùë° ùë£ and a reset gate ùëü ùë° ùë£ . The gated controlled propagation on G ùë†,ùë¢ models the sequential effect behind user behavior. We obtain the output of the last hidden layer as the sequential encoding of POIs:",
  "4.3 Soft-attention Mechanism": "After encoding the two constructed graphs from user's previous visiting history, we introduce a soft-attention mechanism to better aggregate the encodings according to current target POI ùë£ ùë° . For geographical graph encoding ùêª ùëî,ùë¢ = [ ‚Ñé 1 , ‚Ñé 2 , ..., ‚Ñé | ùë† ùë¢ | ] , we denote ùë£ ùë° 's hidden representation ‚Ñé ùë° as the query, the soft-attention mechanism DisenPOI: Disentangling Sequential and Geographical Influence for Point-of-Interest Recommendation WSDM'23, February 27-March 3, 2023, Singapore, Singapore. to generate geographical embedding ùëí ùëî,ùë¢ is formulated as:   where ùúé denotes sigmoid function, the attention vector ùõº ùëî ‚àà R ùê∑ , query and key matrix ùëÑ ùëî , ùêæ ùëî ‚àà R ùê∑ √ó ùê∑ are trainable parameters. Similarly, for ùêª ùë†,ùë¢ = [ ‚Ñé ‚Ä≤ 1 , ‚Ñé ‚Ä≤ 2 , ..., ‚Ñé ‚Ä≤ | ùë† ùë¢ | ] , we take ùë£ ùë° 's initial embedding ùë• ùë° as query vector to generate sequential embedding ùëí ùë†,ùë¢ :",
  "4.4 Self-supervised Disentanglement": "Since the sequential and geographical effects have separate influences on next-to-visit POI, it is essential to disentangle the two representations, ùëí ùëî,ùë¢ and ùëí ùë†,ùë¢ , from each other so that model could fully utilize the information for CTR prediction. Inspired by previous work on self-supervised disentanglement learning [42], we suggest obtaining proxies for both embeddings. Specifically, two readout functions are applied to the outputs of the graph propagation layer. We choose mean pooling as readout function to apply to both geographical neighbors and user's previous visited POIs to generate two proxies for ùëí ùëî,ùë¢ and ùëí ùë†,ùë¢ . Formally, we have:   which conduct mean pooling on ùë† ùë¢ 's one-hop geographical neighbors N ùë† ùë¢ and ùë† ùë¢ respectively. Since ùëù ùëî,ùë¢ and ùëù ùë†,ùë¢ are readout from two different graphs, it's reasonable to assume that each proxy carries representative information of its corresponding graph features. To be specific, we assume that ùëù ùëî,ùë¢ carries abundant information about the user's geographical preference, while ùëù ùë†,ùë¢ carries information about the user's historical interests. Before the embeddings and their proxies were sent to generate self-supervising signals, we design projection heads for each disentangled representations following previous work [2]. To formulate, the projected representations are calculated as:   where proj ùëî , proj ùë† : R ùê∑ ‚Üí R ùê∑ are linear transformations with trainable parameters. The projection heads project the embeddings into another latent space where information from different aspects can be easily clarified. We treat the projected pooling representations, ùëù ‚Ä≤ ùëî,ùë¢ and ùëù ùë†,ùë¢ ‚Ä≤ as hidden proxies for ùëí ‚Ä≤ ùëî,ùë¢ and ùëí ‚Ä≤ ùë†,ùë¢ , which brings supervising signals for self-supervised disentanglement. In other words, the two proxies serve as positive samples for the corresponding embedding, while serving as negative samples for each other. With the above assumption, we introduce the following contrastive loss:  where ùëì (¬∑) denotes the Bayesian Personalized Ranking loss [21]. Formally, we have:  where ‚ü®¬∑ , ¬∑‚ü© denotes the inner product of two given representations.",
  "4.5 Location-based CTR Prediction Layer": "4.5.1 Model Prediction. After obtaining the disentangled embeddings of the user's visiting history ùëí ùëî,ùë¢ and ùëí ùë†,ùë¢ , we concatenate the embeddings with target ùë£ ùë° 's embedding ùë• ùë° and geographical representation ‚Ñé ùë° . A 2-layer MLP is applied to predict the clickthrough rate of ùë£ ùëñ , i.e. ÀÜ ùë¶ , which is a common practice in CTR prediction [43, 44]. Formally, ÀÜ ùë¶ is calculated by:  4.5.2 Target Function and Curriculum Learning. Given the label ùë¶ , we adopt binary cross-entropy loss for supervised CTR prediction, which is formulated as:  After adding the disentangled constraint to the model, we have the overall model loss:  where ùõΩ is the weight of disentanglement. To optimize the model, we propose a curriculum learning method to have the training process follow an easy-to-difficult process. To be specific, we train the model with a warm-up procedure by dynamically increasing the weight of the contrastive loss:  where ùõº and ùõæ are hyper-parameters, ùëò denotes the current curriculum number. Under curriculum training, the strength of disentanglement would increase to the maximum.",
  "5 EXPERIMENT": "In this section, we conduct comprehensive experiments on three real-world location-based recommendation datasets to answer the following research questions: RQ1: How does the proposed DisenPOI perform compared with the current state-of-art baseline methods on location-based CTR predictions? How can DisenPOI alleviate the data sparsity issue with the help of disentangled information? RQ2: Is the idea of disentangling geographical and sequential influence necessary to achieve a promising model performance? What are the influences of the different hyper-parameters? RQ3: How effectively does DisenPOI disentangle POI representations? Can DisenPOI recommend POIs with marked geographical structure as expected? WSDM'23, February 27-March 3, 2023, Singapore, Singapore. Yifang Qin et al. Table 1: Descriptive statistics of our three datasets.",
  "5.1 Experimental Setup": "5.1.1 Evaluation Datasets. We conduct experiments on three realworld datasets collected from two platforms, namely Foursquare [39] and Meituan to evaluate the proposed model. The detailed statistics of the three datasets are presented in table 1. (1) Foursquare 1 : It contains two subsets, which are users' check-in records collected in Tokyo and New York City respectively from 12 April 2012 to 16 February 2013. There are 573,703 check-ins in Tokyo dataset and 227,428 check-ins in New York City (NYC). (2) Meituan : It is a dataset drawn from Meituan users' check-ins to restaurants from 7 July 2021 to 20 July 2021. We collect the records in Shanghai, which has 470,095 check-ins, with 164,855 users and 5,077 POIs included. We sort the recorded user interactions in each dataset in chronological order. All visited POIs and the corresponding previous visiting subsequences make up the positive samples. For each positive sample, we randomly select one of the user's unvisited POIs as the negative sample. The last interaction of each user is reserved for evaluation, while the remaining part is used for training. The evaluation set is then randomly split into two equal-sized subsets as test and validation set respectively. 5.1.2 Baselines. To demonstrate the effectiveness of the proposed DisenPOI, we compare it with three classes of baselines: (A) Traditional sequence-based methods; (B) Graph-based methods; and (C) Location-based methods which leverage geographical information. ¬∑ DIN [44] (A): a classical method for sequence-based CTR prediction that uses target attention for user's context embedding. ¬∑ DIEN [43] (A): a variant of DIN which leverages GRUs to capture the evolution of user interest. ¬∑ SR-GNN [36] (B): a graph-based method that models user's interaction history as session graphs. ¬∑ NGCF [30] (B): a graph-based method that applies GNN on the user-item interaction graph. ¬∑ LightGCN [10] (B): a variant of NGCF. It's one of the state-of-art methods for graph-based recommendation. ¬∑ GeoIE [28] (C): one of the state-of-art location-based recommendation methods, which takes the influence of geographical location and distance into consideration. ¬∑ LSTPM [24] (C): an LSTM-based method that proposes the geodilated LSTM to model geographical effect. ¬∑ GSTN [35] (C): a location-based graph recommendation model that optimizes the spatial-temporal similarities between POIs. Since we have constructed training and evaluation set with positive and negative samples, we adopt AUC and Logloss as evaluation 1 https://sites.google.com/site/yangdingqi/home/foursquare-dataset Table 2: The performance of DisenPOI (Ours) and other baseline methods over three datasets. ‚òÖ indicates DisenPOI outperforms the best POI at p-value<0.05 level, unpaired t-test. metrics, which is a common practice in CTR prediction [43, 44]. The experiment results on three datasets are shown in table 2. 5.1.3 Implementation Detail. We implement our DisenPOI and all baselines in Pytorch. The embedding size is fixed to 64. While some of the above baseline models are not intended for CTR prediction, we apply the same-sized 2-layer MLP on the backend of each model to compare their performances on CTR prediction on an equal basis. For DisenPOI, we set hyper-parameters ùõº = 0 . 2 , ùõæ = 0 . 004 for training and evaluation and we use 2 layers of GNNs on both graph modules. The distance threshold Œî ùëë is set to 1km when constructing geographical graphs. All models are optimized with Adam optimizer with the learning rate ùëôùëü = 0 . 001. Our implementation is publicly available at https://github.com/Yifang-Qin/DisenPOI",
  "5.2 Performance Comparison (RQ1)": "5.2.1 Overall Comparison. As shown in table 2, methods that leverage geographical information (GeoIE, LSTPM, GSTN, and DisenPOI) generally outperform other models, which is a reasonable result since the high relativity between user's check-in history and POIs' geographical locations in location-based recommendation tasks. The proposed DisenPOI outperforms all of the state-of-art baselines with a significant improvement. In particular, the testing AUC is improved over the strongest baseline w.r.t AUC by 1.7%, 2.0%, 0.3%; Logloss by 1.3%, 1.1%, 0.2% in Foursquare Tokyo , Foursquare NYC and Meituan respectively. The result shows that DisenPOI achieves the best performance on CTR prediction task. 5.2.2 Performance on Cold-start Recommendation. To investigate whether the idea of disentangling sequential and geographical influence behind visitings can help to alleviate the cold-start issue, we randomly divide each user's visiting sequences into five folds, corresponding to 20%, 40%, 60%, 80%, and full train set. The experiment results are illustrated in Figure 3. We can observe that: ¬∑ Generally, location-based methods (DisenPOI, GeoIE) can better alleviate the cold-start issue, which indicates that geographical information is essential when dealing with sparse interactions. DisenPOI: Disentangling Sequential and Geographical Influence for Point-of-Interest Recommendation WSDM'23, February 27-March 3, 2023, Singapore, Singapore. 20% 40% 60% 80% 100% 0.780 0.820 0.860 0.900 0.940 0.980 AUC DisenPOI NGCF LightGCN SR-GNN GeoIE DIN Data sparsity 20% 40% 60% 80% 100% Data sparsity 0.340 0.380 0.420 0.460 0.500 0.540 Logloss DisenPOI NGCF LightGCN SR-GNN GeoIE DIN (a) AUC on Tokyo 20% 40% 60% 80% 100% 0.720 0.760 0.800 0.840 0.880 0.920 AUC DisenPOI NGCF LightGCN SR-GNN GeoIE DIN Data sparsity (b) AUC on NYC 20% 40% 60% 80% 100% Data sparsity 0.420 0.460 0.500 0.540 0.580 0.620 0.660 Logloss DisenPOI NGCF LightGCN SR-GNN GeoIE DIN (c) Logloss on Tokyo (d) Logloss on NYC Figure 3: Model performance under cold-start settings. AUC Logloss 0.800 0.820 0.840 0.860 0.880 0.900 0.920 0.940 0.960 AUC 0.300 0.340 0.380 0.420 0.460 0.500 0.540 0.580 Logloss Origin w/o sess-graph w/o geo-graph (a) Tokyo AUC Logloss 0.800 0.820 0.840 0.860 0.880 0.900 0.920 0.940 0.960 AUC 0.300 0.340 0.380 0.420 0.460 0.500 0.540 0.580 Logloss Origin w/o sess-graph w/o geo-graph (b) NYC Logloss Figure 4: Analysis of the dual graph module of DisenPOI. 0.2km 0.4km 0.6km 0.8km 1.0km 1.2km 0.890 0.900 0.910 0.920 0.930 0.940 AUC 48 135 231 331 442 566 Node degree AUC Logloss 0.350 0.370 0.390 0.410 0.430 0.450 (c) Tokyo 0.2km 0.4km 0.6km 0.8km 1.0km 1.2km 0.860 0.870 0.880 0.890 0.900 0.910 AUC 22 77 161 268 395 536 Node degree AUC Logloss 0.410 0.430 0.450 0.470 0.490 0.510 Logloss (d) NYC ¬∑ DisenPOI outperforms all baselines under each setting, showing its capability of learning effective representations on sparse data. Specifically, DisenPOI gains more advantages when the training data is rather sparse (under 60%).",
  "5.3 Analysis of DisenPOI (RQ2)": "We conduct ablation studies to figure out the functionality and effectiveness of each part in DisenPOI. The following ablation studies are carried out on two Foursquare datasets. 5.3.1 Effectiveness of Dual Graphs. To analyze how DisenPOI utilizes the graph data from both geographical and sequential perspectives, we evaluate the model performance under three different settings: the original model, the model without geographical graph (w/o geo-graph), and the model without sequential graph (w/o sessgraph). Since the POI graph G ùëî is built based on a specified distance threshold Œî ùëë , we adjust its value between 0.2 km and 1.2 km to analyze the model's sensitivity to G ùëî . Figure 4 shows: ¬∑ The outputs of both graph modules play different roles to make recommendations. Whenever removing a type of graph, the model performance declines significantly. AUC Logloss 0.840 0.860 0.880 0.900 0.920 0.940 AUC 0.300 0.340 0.380 0.420 0.460 0.500 Logloss DisenPOI w/o GNN GCN-layer (a) Tokyo 0 1 2 3 GNN layer 0.840 0.860 0.880 0.900 0.920 0.940 AUC Logloss 0.350 0.370 0.390 0.410 0.430 0.450 Logloss (b) Tokyo AUC Logloss 0.820 0.840 0.860 0.880 0.900 0.920 AUC 0.380 0.420 0.460 0.500 0.540 0.580 Logloss DisenPOI w/o GNN GCN-layer (c) NYC 0 1 2 3 GNN layer 0.810 0.830 0.850 0.870 0.890 0.910 AUC Logloss 0.420 0.440 0.460 0.480 0.500 0.520 Logloss (d) NYC AUC Figure 5: Ablation study of GNN layer on Foursquare Tokyo. 0 0.01 0.1 0.2 0.5 1 2 0.840 0.860 0.880 0.900 0.920 0.940 AUC AUC Logloss 0.330 0.350 0.370 0.390 0.410 0.430 Logloss (a) Influence of ùõº AUC Logloss 0.840 0.860 0.880 0.900 0.920 0.940 AUC 0.300 0.340 0.380 0.420 0.460 0.500 Logloss DisenPOI w/o Curriculum Learn(fixed) w/o Curriculum Learn(random) (b) Influce of Curriclum Learning Figure 6: Performance under different contrastive settings. ¬∑ When the distance threshold Œî ùëë increases, the density of G ùëî (average node degree) increases correspondingly, the model performance increase to the optimal and then suffer from a decline. A reasonable Œî ùëë is 1km, which is close to real world situations. 5.3.2 Difference Between Graph Propagation Methods. As we have proposed two different graph propagation methods for different types of graphs respectively, we investigate the effectiveness of the proposed graph propagation layers. To be specific, we compare model performance when the number of propagation layers is set from 0 (w/o GNN) to 3. We also compare the performance when the GNN layers are replaced by graph convolution networks (i.e. GCN[13]). Based on the results shown in Figure 5, we have: ¬∑ It's important to design specific GNN structures for different graph topologies. Since we adapt two different types of GNNs to better capture the geographical and sequential influence, the model performance would decline once the graph propagation layers are replaced with plain GCNs. ¬∑ The model achieves its best performance when 2 GNN layers are used, under which setting the model could leverage high-order connectivity of POI nodes on the graph. When there is no GNN layers or the layer amount larger than two, the model would suffer from degenerating or over-smoothing issue of GNNs. 5.3.3 Influence of Disentanglement And Curriculum Learning. The contrastive loss L con in the proposed model serves as a constraint on the model to ensure the similarity between the corresponding graph embeddings and the disentanglement between different types of graph embeddings. To figure out the effectiveness of L con, we compare the model performance with different contrastive weight ùõº from 0 (w/o contrastive loss) to 2.0. Since the curriculum learning method is applied so that the model converges to a better solution, we compare the model performance under three curriculum AUC WSDM'23, February 27-March 3, 2023, Singapore, Singapore. Yifang Qin et al. (a) Graph Encoding with L con Sess-graph encoding Geo-graph encoding Sess-graph encoding Geo-graph encoding (b) Graph Encoding without L con 0 5 10 15 20 25 30 35 Distance (km) 0 100 200 300 400 500 Number of POIs DisenPOI DIN DisenPOI DIN (c) Distance distribution of recommended POIs. (d) User's check-in trajectory. Figure 7: Visualizations of graph encodings and geographical distribution of recommended POIs. settings: our original model, DisenPOI without curriculum learning (with fixed ùõº ), and DisenPOI with ùõº randomly set under each curriculum step. We conduct the ablation experiments on Tokyo dataset and the results are illustrated in Figure 6. We observe that: ¬∑ The contrastive loss improves model performance since the disentangled influence of location and history sequence can be fully utilized to make a prediction. Entangled representations would influence the CTR prediction layer to make a biased or sub-optimal prediction. Generally models with larger ùõº perform better, before suffering with an extreme ùõº (greater than 1.0). ¬∑ It is necessary to train the model in an easy-to-difficult process to achieve better performance. The models trained with fixed or random ùõº are both likely to converge to a sub-optimal solution instead according to Figure 6b.",
  "5.4 Visualization and Case Study (RQ3)": "5.4.1 Visualization of Model Output. To further investigate how the proposed DisenPOI disentangles the hidden representation of POIs, we visualize the representations of user's check-in sequences on the evaluation set. The encodings of visiting sequences are transformed via the t-SNE [25] method. The result shown in Figure 7a and 7b illustrates the effect of disentanglement. To be specific, encodings of sequential and geographical graphs form rather clearer cluster structures compared with the model without L con. The comparison indicates that with the contrastive constraint brought by L con, DisenPOI successfully clarifies different types of embeddings and encodes two graphs into disentangled latent spaces. To demonstrate the effectiveness of the proposed location-based idea, we illustrate in Figure 7c by comparing the distance between target POIs in the evaluation set and the predictions made by DisenPOI and DIN. It shows that DisenPOI does a better job in recommending POIs that are close to the target than traditional methods. Table 3: Difference of top recommended POIs. 5.4.2 Case Study. We randomly choose a user (488) who has a visiting sequence with 148 POIs for detailed investigation. We compare the top-100 recommended POIs of DisenPOI and DIN for the selected user (488) in Figure 7d. POIs visited by the user are marked with green circles, while POIs recommended by DisenPOI and DIN are marked with blue and red circles respectively. It can be observed that the POIs recommended by DisenPOI are generally closer to the selected user's visiting trajectory than POIs recommended by DIN, which shows the effectiveness of modeling location-based influence with a geographical POI graph. To make an intuitive comparison, we compare the top scored POIs recommended by DisenPOI and DIN in Table 3. We first list the distance and categories of top-5 recommended POIs, then the average distance and accuracy on the category of top-50 recommended POIs. It can be observed that DIN pays more attention to other features of the target POI, such as its category (e.g. train station) and functionality (e.g. transportation), while DisenPOI considers both geographical influence and POI's functionality when making recommendations. The results shows that the ignorance of geographical effects will cause models to recommend POIs that share similarities with user interests but at a rather far distance, which is less likely to be visited next. By contrast, DisenPOI would prefer a similar POI within a short distance from user's current location, which helps it to make more reasonable recommendations.",
  "6 CONCLUSION": "In this paper, we propose DisenPOI, a dual-graph model that disentangles sequential and geographical influence for Point-of-Interest recommendations. We construct a pair of a sequence-based graph G ùë†,ùë¢ and a location-based graph G ùëî,ùë¢ to model the disentangled sequential and geographical factor behind a visit. We use customized graph propagation schemes for accurate delineation of different semantics on both graphs and leverage contrastive loss to achieve disentanglement. Experiments on three datasets demonstrate the effectiveness and expressiveness of DisenPOI to disentangle sequential and geographical influence on location-based CTR prediction.",
  "ACKNOWLEDGMENT": "This paper is partially supported by National Key Research and Development Program of China with Grant No. 2018AAA0101902 and the National Natural Science Foundation of China (NSFC Grant Numbers 62276002 and 62106008) DisenPOI: Disentangling Sequential and Geographical Influence for Point-of-Interest Recommendation WSDM'23, February 27-March 3, 2023, Singapore, Singapore.",
  "REFERENCES": "[1] Yoshua Bengio, Aaron Courville, and Pascal Vincent. 2013. Representation learning: A review and new perspectives. IEEE transactions on pattern analysis and machine intelligence 35, 8 (2013), 1798-1828. [2] Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton. 2020. A simple framework for contrastive learning of visual representations. In International conference on machine learning . PMLR, 1597-1607. [3] Chen Cheng, Haiqin Yang, Irwin King, and Michael Lyu. 2012. Fused matrix factorization with geographical and social influence in location-based social networks. In Proceedings of the AAAI conference on artificial intelligence , Vol. 26. 17-23. [4] Chen Cheng, Haiqin Yang, Michael R Lyu, and Irwin King. 2013. Where you like to go next: Successive point-of-interest recommendation. In Twenty-Third international joint conference on Artificial Intelligence . [5] Yunfei Chu, Xiaofu Chang, Kunyang Jia, Jingzhen Zhou, and Hongxia Yang. 2021. Dynamic Sequential Graph Learning for Click-Through Rate Prediction. arXiv preprint arXiv:2109.12541 (2021). [6] Jie Feng, Yong Li, Chao Zhang, Funing Sun, Fanchao Meng, Ang Guo, and Depeng Jin. 2018. Deepmove: Predicting human mobility with attentional recurrent networks. In Proceedings of the 2018 world wide web conference . 1459-1468. [7] Huiji Gao, Jiliang Tang, Xia Hu, and Huan Liu. 2015. Content-aware point of interest recommendation on location-based social networks. In Twenty-ninth AAAI conference on Artificial Intelligence . [8] Huiji Gao, Jiliang Tang, and Huan Liu. 2012. gSCorr: Modeling geo-social correlations for new check-ins on location-based social networks. In Proceedings of the 21st ACM international conference on Information and knowledge management . 1582-1586. [9] Will Hamilton, Zhitao Ying, and Jure Leskovec. 2017. Inductive representation learning on large graphs. Advances in neural information processing systems 30 (2017). [10] Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang. 2020. Lightgcn: Simplifying and powering graph convolution network for recommendation. In Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval . 639-648. [11] Wei Ju, Yifang Qin, Ziyue Qiao, Xiao Luo, Yifan Wang, Yanjie Fu, and Ming Zhang. 2022. Kernel-based Substructure Exploration for Next POI Recommendation. arXiv preprint arXiv:2210.03969 (2022). [12] Wei Ju, Junwei Yang, Meng Qu, Weiping Song, Jianhao Shen, and Ming Zhang. 2022. KGNN: Harnessing Kernel-based Networks for Semi-supervised Graph Classification. In Proceedings of the Fifteenth ACM International Conference on Web Search and Data Mining . 421-429. [13] Thomas N Kipf and Max Welling. 2016. Semi-supervised classification with graph convolutional networks. arXiv preprint arXiv:1609.02907 (2016). [14] Huayu Li, Yong Ge, Richang Hong, and Hengshu Zhu. 2016. Point-of-interest recommendations: Learning potential check-ins from friends. In Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining . 975-984. [15] Yujia Li, Richard Zemel, Marc Brockschmidt, and Daniel Tarlow. 2016. Gated Graph Sequence Neural Networks. In Proceedings of ICLR'16 . [16] Zeyu Li, Wei Cheng, Haiqi Xiao, Wenchao Yu, Haifeng Chen, and Wei Wang. 2021. You Are What and Where You Are: Graph Enhanced Attention Network for Explainable POI Recommendation. In Proceedings of the 30th ACM International Conference on Information & Knowledge Management . 3945-3954. [17] Defu Lian, Vincent W Zheng, and Xing Xie. 2013. Collaborative filtering meets next check-in location prediction. In Proceedings of the 22nd International Conference on World Wide Web . 231-232. [18] Qiang Liu, Shu Wu, Liang Wang, and Tieniu Tan. 2016. Predicting the next location: A recurrent model with spatial and temporal contexts. In Thirtieth AAAI conference on artificial intelligence . [19] Xiao Luo, Wei Ju, Meng Qu, Chong Chen, Minghua Deng, Xian-Sheng Hua, and Ming Zhang. 2022. DualGraph: Improving Semi-supervised Graph Classification via Dual Contrastive Learning. In 2022 IEEE 38th International Conference on Data Engineering (ICDE) . IEEE, 699-712. [20] Jianxin Ma, Chang Zhou, Peng Cui, Hongxia Yang, and Wenwu Zhu. 2019. Learning disentangled representations for recommendation. Advances in neural information processing systems 32 (2019). [21] Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2012. BPR: Bayesian personalized ranking from implicit feedback. arXiv preprint arXiv:1205.2618 (2012). [22] Steffen Rendle, Christoph Freudenthaler, and Lars Schmidt-Thieme. 2010. Factorizing personalized markov chains for next-basket recommendation. In Proceedings of the 19th international conference on World wide web . 811-820. [23] Ruslan Salakhutdinov and Andriy Mnih. 2008. Bayesian probabilistic matrix factorization using Markov chain Monte Carlo. In Proceedings of the 25th international conference on Machine learning . 880-887. [24] Ke Sun, Tieyun Qian, Tong Chen, Yile Liang, Quoc Viet Hung Nguyen, and Hongzhi Yin. 2020. Where to go next: Modeling long-and short-term user preferences for point-of-interest recommendation. In Proceedings of the AAAI Conference on Artificial Intelligence , Vol. 34. 214-221. [25] Laurens Van der Maaten and Geoffrey Hinton. 2008. Visualizing data using t-SNE. Journal of machine learning research 9, 11 (2008). [26] Petar Veliƒçkoviƒá, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Lio, and Yoshua Bengio. 2017. Graph attention networks. arXiv preprint arXiv:1710.10903 (2017). [27] Dongjie Wang, Pengyang Wang, Kunpeng Liu, Yuanchun Zhou, Charles E Hughes, and Yanjie Fu. 2021. Reinforced imitative graph representation learning for mobile user profiling: An adversarial training perspective. In Proceedings of the AAAI Conference on Artificial Intelligence , Vol. 35. 4410-4417. [28] Hao Wang, Huawei Shen, Wentao Ouyang, and Xueqi Cheng. 2018. Exploiting POI-Specific Geographical Influence for Point-of-Interest Recommendation.. In IJCAI . 3877-3883. [29] Pengyang Wang, Kunpeng Liu, Lu Jiang, Xiaolin Li, and Yanjie Fu. 2020. Incremental mobile user profiling: Reinforcement learning with spatial knowledge graph for modeling event streams. In Proceedings of the 26th ACM SIGKDD international conference on knowledge discovery & data mining . 853-861. [30] Xiang Wang, Xiangnan He, Meng Wang, Fuli Feng, and Tat-Seng Chua. 2019. Neural graph collaborative filtering. In Proceedings of the 42nd international ACM SIGIR conference on Research and development in Information Retrieval . 165-174. [31] Xiang Wang, Tinglin Huang, Dingxian Wang, Yancheng Yuan, Zhenguang Liu, Xiangnan He, and Tat-Seng Chua. 2021. Learning intents behind interactions with knowledge graph for recommendation. In Proceedings of the Web Conference 2021 . 878-887. [32] Xiang Wang, Hongye Jin, An Zhang, Xiangnan He, Tong Xu, and Tat-Seng Chua. 2020. Disentangled graph collaborative filtering. In Proceedings of the 43rd international ACM SIGIR conference on research and development in information retrieval . 1001-1010. [33] Yifan Wang, Yifang Qin, Fang Sun, Bo Zhang, Xuyang Hou, Ke Hu, Jia Cheng, Jun Lei, and Ming Zhang. 2022. DisenCTR: Dynamic Graph-based Disentangled Representation for Click-Through Rate Prediction. In Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval . [34] Yifan Wang, Suyao Tang, Yuntong Lei, Weiping Song, Sheng Wang, and Ming Zhang. 2020. Disenhan: Disentangled heterogeneous graph attention network for recommendation. In Proceedings of the 29th ACM International Conference on Information & Knowledge Management . 1605-1614. [35] Zhaobo Wang, Yanmin Zhu, Qiaomei Zhang, Haobin Liu, Chunyang Wang, and Tong Liu. 2022. Graph-enhanced Spatial-temporal Network for Next POI Recommendation. ACM Transactions on Knowledge Discovery from Data (TKDD) (2022). [36] Shu Wu, Yuyuan Tang, Yanqiao Zhu, Liang Wang, Xing Xie, and Tieniu Tan. 2019. Session-based recommendation with graph neural networks. In Proceedings of the AAAI conference on artificial intelligence , Vol. 33. 346-353. [37] Keyulu Xu, Chengtao Li, Yonglong Tian, Tomohiro Sonobe, Ken-ichi Kawarabayashi, and Stefanie Jegelka. 2018. Representation learning on graphs with jumping knowledge networks. In International Conference on Machine Learning . PMLR, 5453-5462. [38] Carl Yang, Lanxiao Bai, Chao Zhang, Quan Yuan, and Jiawei Han. 2017. Bridging collaborative filtering and semi-supervised learning: a neural approach for poi recommendation. In Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining . 1245-1254. [39] Dingqi Yang, Daqing Zhang, Vincent W Zheng, and Zhiyong Yu. 2014. Modeling user activity preference by leveraging user spatial temporal characteristics in LBSNs. IEEE Transactions on Systems, Man, and Cybernetics: Systems 45, 1 (2014), 129-142. [40] Quan Yuan, Gao Cong, and Aixin Sun. 2014. Graph-Based Point-of-Interest Recommendation with Geographical and Temporal Influences. In Proceedings of the 23rd ACM International Conference on Conference on Information and Knowledge Management . 659--668. [41] Pengpeng Zhao, Anjing Luo, Yanchi Liu, Fuzhen Zhuang, Jiajie Xu, Zhixu Li, Victor S Sheng, and Xiaofang Zhou. 2020. Where to go next: A spatio-temporal gated network for next poi recommendation. IEEE Transactions on Knowledge and Data Engineering (2020). [42] Yu Zheng, Chen Gao, Jianxin Chang, Yanan Niu, Yang Song, Depeng Jin, and Yong Li. 2022. Disentangling Long and Short-Term Interests for Recommendation. arXiv preprint arXiv:2202.13090 (2022). [43] Guorui Zhou, Na Mou, Ying Fan, Qi Pi, Weijie Bian, Chang Zhou, Xiaoqiang Zhu, and Kun Gai. 2019. Deep interest evolution network for click-through rate prediction. In Proceedings of the AAAI conference on artificial intelligence , Vol. 33. 5941-5948. [44] Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018. Deep interest network for click-through rate prediction. In Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery & data mining . 1059-1068.",
  "keywords_parsed": [
    "Point-of-Interest (POI) recommendation plays a vital role in various location-aware services. It has been observed that POI recommendation is driven by both sequential and geographical influences. However",
    " since there is no annotated label of the dominant influence during recommendation",
    " existing methods tend to entangle these two influences",
    " which may lead to sub-optimal recommendation performance and poor interpretability. In this paper",
    " we address the above challenge by proposing DisenPOI ",
    " a novel Disen tangled dual-graph framework for POI recommendation",
    " which jointly utilizes sequential and geographical relationships on two separate graphs and disentangles the two influences with self-supervision. The key novelty of our model compared with existing approaches is to extract disentangled representations of both sequential and geographical influences with contrastive learning. To be specific",
    " we construct a geographical graph and a sequential graph based on the check-in sequence of a user. We tailor their propagation schemes to become sequence-/geo-aware to better capture the corresponding influences. Preference proxies are extracted from check-in sequence as pseudo labels for the two influences",
    " which supervise the disentanglement via a contrastive loss. Extensive experiments on three datasets demonstrate the superiority of the proposed model."
  ]
}